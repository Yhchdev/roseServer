from flask import Flask
from flask_cors import CORS
from flask_mqtt import Mqtt
from flask_socketio import SocketIO

import json

from app.user import user
from app.rose import rose

app = Flask(__name__)
CORS(app, resources={r"/*": {"origins": "*"}})  # 允许所有域名跨域
CORS(app, supports_credentials=True)

app.config['SECRET'] = 'yhchdev'
app.config['TEMPLATES_AUTO_RELOAD'] = True
app.config['MQTT_BROKER_URL'] = '193.112.77.165'
app.config['MQTT_BROKER_PORT'] = 1883
app.config['MQTT_USERNAME'] = ''
app.config['MQTT_PASSWORD'] = ''
app.config['MQTT_KEEPALIVE'] = 5
app.config['MQTT_TLS_ENABLED'] = False
mqtt = Mqtt(app)
socketio = SocketIO(app)

app.register_blueprint(user, url_prefix='/user')
app.register_blueprint(rose, url_prefix='/rose')



# 连接后 订阅主题
@mqtt.on_connect()
def handle_connect(client, userdata, flags, rc):
    mqtt.subscribe('rose/pic_base64')
    print("Connected with result code " + str(rc))



'''
收到消息后 执行的方法
{"now": 1565009394.6654263,
"msg": "this is test pic from rspi",
"state": "0",
"id": "85e5879a-b77f-11e9-b88b-b827eb1ee558",
"pic": [null, null, null, null], 
"model": 1}'

{"now": 1565009394.6654263,"msg": "this is test pic from rspi","state": "0","id": "85e5879a-b77f-11e9-b88b-b827eb1ee558","pic": ["data:image/jpeg;base64,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", "pic2", "pic3", "pic4"], "model": 1}

'''


@mqtt.on_message()
def handle_mqtt_message(client, userdata, message):
    print(str(message.payload))





# 发布主题和信息
@app.route('/mqtt/pub/<want_to_pub>', methods=['GET'])
def pub_my_msg(want_to_pub):
    mqtt.publish('rose/control',want_to_pub)
    return want_to_pub




if __name__ == '__main__':
    socketio.run(app, host='0.0.0.0', port=5000, use_reloader=True, debug=True)